---
{"dg-publish":true,"permalink":"/Linux_study/软件包管理和网络基础/"}
---

[toc]
# 软件包管理和网络基础
**内容包含**：软件包管理（指令下载、更新、卸载），网络命令（查看ip等）
## 软件包管理
**apt**（Advanced Packaging Tool）是一个在 Debian 和 Ubuntu 中的 Shell 前端软件包管理器。其提供了查找、安装、升级、删除某一个、一组甚至全部软件包的命令
### apt语法
 apt [options] [command] [package ...]
 - **options**：可选，选项包括 -h（帮助），-y（当安装过程提示选择全部为"yes"），-q（不显示安装的过程）等等。
- **command**：要进行的操作。
- **package**：安装的包名。

### apt 常用命令
- 列出所有可更新的软件清单命令：**sudo apt update**

- 升级软件包：**sudo apt upgrade**

- 列出可更新的软件包及版本信息：**apt list --upgradable**

- 升级软件包，升级前先删除需要更新软件包：**sudo apt full-upgrade**

- 安装指定的软件命令：**sudo apt install <package_name>**

- 安装多个软件包：**sudo apt install <package_1> <package_2> <package_3>**

- 更新指定的软件命令：**sudo apt update <package_name>**

- 显示软件包具体信息,例如：版本号，安装大小，依赖关系等等：**sudo apt show <package_name>**

- 删除软件包命令：**sudo apt remove <package_name>**

- 清理不再使用的依赖和库文件: **sudo apt autoremove**

- 移除软件包及配置文件: **sudo apt purge <package_name>**

- 查找软件包命令： **sudo apt search <keyword>**

- 列出所有已安装的包：**apt list --installed**

- 列出所有已安装的包的版本信息：**apt list --all-versions**
### apt 指令测试
1. **sudo apt update**、**sudo apt upgrade**、**apt list --upgradable**
<a href="https://ibb.co/Zp9zVVsj"><img src="https://i.ibb.co/ksZ2xxn7/apt-1.png" alt="apt-1" border="0"></a>
2. **sudo apt install <package_name>**、**sudo apt autoremove**
<a href="https://ibb.co/1twjMfQc"><img src="https://i.ibb.co/YFqwX7Qg/apt-2.png" alt="apt-2" border="0"></a>
3. **sudo apt show <package_name>**、**dpkg**
<a href="https://ibb.co/XfgSg6GT"><img src="https://i.ibb.co/Q7RrRhxG/apt-4.png" alt="apt-4" border="0"></a>
<a href="https://ibb.co/TxdmyjGJ"><img src="https://i.ibb.co/hJwD0QNr/apt-3.png" alt="apt-3" border="0"></a>
4. **sudo apt autoremove**
5. <a href="https://ibb.co/HTjXvzy1"><img src="https://i.ibb.co/whfYHWq3/apt-5.png" alt="apt-5" border="0"></a>
6.  **sudo apt search <keyword>**
 <a href="https://ibb.co/kVBSd91h"><img src="https://i.ibb.co/wZgzvwsK/apt-6.png" alt="apt-6" border="0"></a>
7. **apt list --installed**
<a href="https://ibb.co/HLJkcCw9"><img src="https://i.ibb.co/SDL9kcYZ/apt-7.png" alt="apt-7" border="0"></a>
## 网络基础
### 1. ifconfig
ifconfig命令用于显示或设置网络设备，来源于 net-tools 工具包。
**格式：**
```
ifconfig [网络设备][down up -allmulti -arp -promisc][add<地址>][del<地址>][<hw<网络设备类型><硬件地址>][io_addr<I/O地址>][irq<IRQ地址>][media<网络媒介类型>][mem_start<内存地址>][metric<数目>][mtu<字节>][netmask<子网掩码>][tunnel<地址>][-broadcast<地址>][-pointopoint<地址>][IP地址]
```
**参数：**
```
add<地址> 设置网络设备IPv6的IP地址
del<地址> 删除网络设备IPv6的IP地址
down 关闭指定的网络设备
<hw<网络设备类型><硬件地址> 设置网络设备的类型与硬件地址
io_addr<I/O地址> 设置网络设备的I/O地址
irq<IRQ地址> 设置网络设备的IRQ
media<网络媒介类型> 设置网络设备的媒介类型
mem_start<内存地址> 设置网络设备在主内存所占用的起始地址
metric<数目> 指定在计算数据包的转送次数时，所要加上的数目
mtu<字节> 设置网络设备的MTU
netmask<子网掩码> 设置网络设备的子网掩码
tunnel<地址> 建立IPv4与IPv6之间的隧道通信地址
up 启动指定的网络设备
-broadcast<地址> 将要送往指定地址的数据包当成广播数据包来处理
-pointopoint<地址> 与指定地址的网络设备建立直接连线，此模式具有保密功能
-promisc 关闭或启动指定网络设备的promiscuous模式
[IP地址] 指定网络设备的IP地址
[网络设备] 指定网络设备的名称
```

### 2. IP
ip 命令和 ifconfig 类似，但前者功能更强大，并旨在取代后者。
<a href="https://ibb.co/Q3FMSfTN"><img src="https://i.ibb.co/pBvdVxMz/ip.png" alt="ip" border="0"></a>
### 3.ping
Linux ping 命令用于检测主机，执行 ping 指令会使用 ICMP 传输协议，发出要求回应的信息，若远端主机的网络功能没有问题，就会回应该信息，因而得知该主机运作正常。
**格式：*ping [参数选项] [主机名或IP地址]***

| 参数| 含义 |
| --- | --- |
| -c | 设置完成要求回应的次数 |
| -i | 指定收发信息的间隔时间 |
| -s | 设置数据包的大小 |
| -w | 在设定的秒后退出 |
### 4.route
route 命令用于显示和操作 IP 路由表。
**格式**：
```
route [-nee]
route add [-net|-host] [网域或主机] netmask [mask] [gw|dev]
route del [-net|-host] [网域或主机] netmask [mask] [gw|dev]
```
| 参数| 含义 |
| --- | --- |
| add | 添加一条路由规则 |
| del | 删除一条路由规则 |
| -net | 目的地址是一个网络 |
| -host | 目的地址是一个主机 |
| target | 目的网络或主机 |
| netmask | 目的地址的网络掩码 |
| gw | 路由数据包通过的网关 |
| dev | 为路由指定的网络接口 |

在命令行下执行 route 命令来添加路由，不会永久保存，当网卡重启或者机器重启之后，该路由就失效了。要想永久保存，有如下方法：

```
1.在 /etc/rc.local 里添加
2.在 /etc/sysconfig/network 里添加到末尾
3./etc/sysconfig/static-router :
any net x.x.x.x/24 gw y.y.y.y
```
route 命令的输出项说明：
```
Destination	目标网段或者主机
Gateway	    网关地址，”*” 表示目标是本主机所属的网络，不需要路由
Genmask	    网络掩码
Flags	    标记。一些可能的标记如下：
 	        U — 路由是活动的
 			H — 目标是一个主机
 			G — 路由指向网关
 			R — 恢复动态路由产生的表项
 			D — 由路由的后台程序动态地安装
 			M — 由路由的后台程序修改
 			! — 拒绝路由
Metric	路由距离，到达指定网络所需的中转数（linux 内核中没有使用）
Ref	    路由项引用次数（linux 内核中没有使用）
Use	    此路由项被路由软件查找的次数
Iface	该路由表项对应的输出接口
```
### 5.lsof
lsof（list open files）是一个查看进程打开的文件的工具
选项：
```
-a：列出打开文件存在的进程
-c<进程名>：列出指定进程所打开的文件
-u：列出 UID 号进程详情
-g：列出 GID 号进程详情
-d<文件号>：列出占用该文件号的进程
+d<目录>：列出目录下被打开的文件
+D<目录>：递归列出目录下被打开的文件
-n<目录>：列出使用 NFS 的文件
-i<条件>：列出符合条件的进程( IPV(4/6)协议	:端口	@ip )
-p<进程号>：列出指定进程号所打开的文件
-n: 不反向解析网络名字
```
### 6.netstart
netstat 用来查看当前操作系统的网络连接状态、路由表、接口统计等信息，来自于 net-tools 工具包，ss 是 netstat 的升级版。
常用命令选项：

```
netstat [-anpt] [-anpu] [-anptu] [-anpltu] [-ntlp]
```


```
-a	显示主机中所有活动的网络连接信息 (包括监听、非监听状态的服务端口)
-n	以数字的形式显示相关的主机地址、端口等信息
-p	显示与网络连接相关联的进程号、进程名称信息 (该选项需要 root 权限)
-l	显示处于监听 (Listen) 状态的网络连接及端口信息
-t	查看 TCP (Transmission Control Protocol，传输控制协议) 相关的信息
-u	显示 UDP (User Datagram Protocol，用户数据报协议) 协议相关的信息
-r	显示路由表信息
-i	显示网卡列表
-g	显示组播组的关系
-s	显示网络统计信息
```
### 7.ss
ss 命令来自于 iproute 包，是 netstat 的升级版本。netstat 通过遍历 /proc 来获取 socket 信息，ss 使用 netlink 与内核 tcp_diag 模块通信获取 socket 信息。
格式：
```
ss [OPTION]... [FILTER]
```
选项：

```
-t: tcp协议相关
-u: udp协议相关
-w: 裸套接字相关
-x：unix sock 相关
-l: listen 状态的连接
-a: 所有
-n: 数字格式
-p: 相关的程序及 PID
-e: 扩展的信息
-m：内存用量
-o：计时器信息
```
### 8.traceroute
traceroute 命令可以用于测试从当前主机到目的主机之间经过了哪些网络结点，并显示各个中间结点的连接状态（响应时间）。对于无法响应的结点，连接状态将显示为 “*”，预设数据包大小是 40Bytes，用户可另行设置。如果没有 traceroute 命令可执行 yum -y install traceroute 安装。
格式：

```
traceroute [参数] [主机|IP]
```
参数：

```
-d 使用 Socket 层级的排错功能
-f 设置第一个检测数据包的存活数值 TTL 的大小
-F 设置勿离断位
-g 设置来源路由网关，最多可设置 8 个
-i 使用指定的网络界面送出数据包
-I 使用 ICMP 回应取代 UDP 资料信息
-m 设置检测数据包的最大存活数值 TTL 的大小
-n 直接使用 IP 地址而非主机名称
-p 设置 UDP 传输协议的通信端口
-r 忽略普通的 Routing Table，直接将数据包送到远端主机上
-s 设置本地主机送出数据包的 IP 地址
-t 设置检测数据包的 TOS 数值
-v 详细显示指令的执行过程
-w 设置等待远端主机回报的时间
-x 开启或关闭数据包的正确性检验
```
### 9.nslookup
域名解析工具，执行 yum -y install bind-utils 安装。
格式：

```
nslookup 域名
```
### 10.dig
也是解析域名，同样来自 bind-utils 包。

```
dig 域名
```
### 11.nmcli
nmcli 命令可以完成网卡上所有的配置工作，并且可以写入配置文件永久生效。centos7 默认安装，没有执行 yum -y install NetworkManager。
nmcli 命令相关术语:
 
```
- 设备即网络接口
 - 连接是对网络接口的配置，一个网络接口可有多个连接配置，但同时只有一个连接配置生效
```
格式：

```
nmcli [OPTIONS] OBJECT { COMMAND | help }
```
选项：

```
-a	询问缺少的参数
-c  是否在输出中使用颜色  
-e  转义值中的列分隔符
-f  指定要输出的字段
-g  -m tabular -t -f 的快捷方式
-m  输出模式
-o  概览模式
-p  更加友好的输出方式
-s  允许显示密码
-t  简洁输出
-v  显示程序版本
-w  设置等待完成操作的超时
```
对象：

```
g[eneral]       NetworkManager 的一般状态和操作
n[etworking]    整体网络控制
r[adio]         NetworkManager 无线电开关
c[onnection]    NetworkManager 的连接
d[evice]        由 NetworkManager 管理的设备
a[gent]         NetworkManager 秘密代理或 polkit 代理
m[onitor]       监控 NetworkManager 的变化
```
### 12. tcpdump
网络数据包截获分析工具。支持针对网络层、协议、主机、网络或端口的过滤。并提供 and、or、not 等逻辑语句帮助去除无用的信息。
格式：

```
tcpdump [-adeflnNOpqStvx][-c<数据包数目>][-dd][-ddd][-F<表达文件>][-i<网络界面>][-r<数据包文件>][-s<数据包大小>][-tt][-T<数据包类型>][-vv][-w<数据包文件>][输出数据栏位]
```
选项：

```
-a 尝试将网络和广播地址转换成名称
-c<数据包数目> 收到指定的数据包数目后，就停止进行倾倒操作
-d 把编译过的数据包编码转换成可阅读的格式，并倾倒到标准输出
-dd 把编译过的数据包编码转换成C语言的格式，并倾倒到标准输出
-ddd 把编译过的数据包编码转换成十进制数字的格式，并倾倒到标准输出
-e 在每列倾倒资料上显示连接层级的文件头
-f 用数字显示网际网络地址
-F<表达文件> 指定内含表达方式的文件
-i<网络界面> 使用指定的网络截面送出数据包
-l 使用标准输出列的缓冲区
-n 不把主机的网络地址转换成名字
-N 不列出域名
-O 不将数据包编码最佳化
-p 不让网络界面进入混杂模式
-q 快速输出，仅列出少数的传输协议信息
-r<数据包文件> 从指定的文件读取数据包数据
-s<数据包大小> 设置每个数据包的大小
-S 用绝对而非相对数值列出TCP关联数
-t 在每列倾倒资料上不显示时间戳记
-tt 在每列倾倒资料上显示未经格式化的时间戳记
-T<数据包类型> 强制将表达方式所指定的数据包转译成设置的数据包类型
-v 详细显示指令执行过程
-vv 更详细显示指令执行过程
-x 用十六进制字码列出数据包资料
-w<数据包文件> 把数据包数据写入指定的文件
```
### 13. arp
arp 命令用于操作主机的 arp 缓冲区，可以用来显示 arp 缓冲区中的所有条目、删除指定的条目或者添加静态的 ip 地址与 MAC 地址对应关系。
格式：

```
arp [-vn]  [<HW>] [-i <if>] [-a] [<hostname>]             <-Display ARP cache
arp [-v]          [-i <if>] -d  <host> [pub]               <-Delete ARP entry
arp [-vnD] [<HW>] [-i <if>] -f  [<filename>]            <-Add entry from file
arp [-v]   [<HW>] [-i <if>] -s  <host> <hwaddr> [temp]            <-Add entry
arp [-v]   [<HW>] [-i <if>] -Ds <host> <if> [netmask <nm>] pub          <-''-
```
参数：

```
-a<主机>：显示 arp 缓冲区的所有条目
-H<地址类型>：指定 arp 指令使用的地址类型
-d<主机>：从 arp 缓冲区中删除指定主机的 arp 条目
-D：使用指定接口的硬件地址
-e：以 Linux 的显示风格显示 arp 缓冲区中的条目
-i<接口>：指定要操作 arp 缓冲区的网络接口
-s<主机><MAC地址>：设置指定的主机的 IP 地址与 MAC 地址的静态映射
-n：以数字方式显示 arp 缓冲区中的条目
-v：显示详细的 arp 缓冲区条目，包括缓冲区条目的统计信息
-f<文件>：设置主机的 IP 地址与 MAC 地址的静态映射
```
### 14. nmap
nmap 是一个强大的端口扫描类安全评测工具，支持 ping 扫描、多端口检测等多种技术。

```
# nmap 软件包安装
rpm -qa | grep nmap
yum -y install nmap
```
格式：
```
nmap [扫描类型] [选项] [扫描目标]
```
常用参数选项：

```
-p：指定扫描的端口
-n：禁用反向 DNS 解析（加快扫描速度）
-sS：TCP 的 SYN 扫描（半开扫描），只向目标发出 SYN 数据包，如果收到 SYN/ACK 响应包就认为目标端口正在监听，并立即断开连接;否则认为目标端口并未开放
-sT：TCP 连接扫描，这是完整的 TCP 扫描方式（默认扫描类型），用来建立一个 TCP 连接，如果成功则认为目标端口正在监听服务，否则认为目标端口并未开放
-sF：TCP 的 FIN 扫描，开放的端口会忽略这种数据包，关闭的端口会回应 RST 数据包。许多防火墙只对 SYN 数据包进行简单过滤，而忽略了其他形式的 TCP 攻击包。这种类型的扫描可间接检测防火墙的健壮性
-sU：UDP 扫描，探测目标主机提供哪些 UDP 服务，UDP 扫描的速度会比较慢
-sP：ICMP 扫描，类似于 ping 检测，快速判断目标主机是否存活，不做其他扫描
-P0：跳过 ping 检测，这种方式认为所有的目标主机是存活的，当对方不响应 ICMP 请求时，使用这种方式可以避免因无法 ping 通而放弃扫描
```
TCP 控制位类型：

```
SYN  建立连接
ACK  确认数据包传输状况
FIN  关闭连接
PSH  推送位
RST  重置
URG  紧急
```
### 网络指令测试
1. ifconfig
<a href="https://ibb.co/gMtWVzZD"><img src="https://i.ibb.co/TBP0LmMH/ifconfig.png" alt="ifconfig" border="0"></a>
2. ip
<a href="https://ibb.co/hJx8NtZ2"><img src="https://i.ibb.co/JwWkTMyr/ip-1.png" alt="ip-1" border="0"></a>
3.  ping
<a href="https://ibb.co/whKMbxK3"><img src="https://i.ibb.co/nMDzV5DZ/ping.png" alt="ping" border="0"></a>
4. route
<a href="https://ibb.co/Pz9CXsSh"><img src="https://i.ibb.co/6J1s9cdP/route.png" alt="route" border="0"></a>
5. lsof
<a href="https://ibb.co/p6NLPsZR"><img src="https://i.ibb.co/spcVPDQ6/lsof.png" alt="lsof" border="0"></a>
6. netstart
<a href="https://ibb.co/b5pYJf3n"><img src="https://i.ibb.co/N2wfS43z/netstart.png" alt="netstart" border="0"></a>
7. ss
<a href="https://ibb.co/k2TQ2Wp9"><img src="https://i.ibb.co/KxgFx3YL/ss.png" alt="ss" border="0"></a>
8. traceroute
<a href="https://ibb.co/m5MPX7rh"><img src="https://i.ibb.co/23fpsB0c/traceroute.png" alt="traceroute" border="0"></a>
9. nslookup
<a href="https://ibb.co/Sbksmk2"><img src="https://i.ibb.co/bT4Wv4x/nslookup.png" alt="nslookup" border="0"></a>
10. dig
<a href="https://ibb.co/LXyTfCdG"><img src="https://i.ibb.co/bMV4nr5f/dig.png" alt="dig" border="0"></a>
11. nmcli
<a href="https://ibb.co/1YVfxkR5"><img src="https://i.ibb.co/j9KvFS32/nmcli.png" alt="nmcli" border="0"></a>
12. tcpdump
<a href="https://ibb.co/LDr88xth"><img src="https://i.ibb.co/hxcyyBW1/tcpdump.png" alt="tcpdump" border="0"></a>
## 遇到的困难和解决方式

|  | 问题| 解决方案 |
| --- | --- | --- |
| 1 |  **dpkg -I qqmusic_1.1.3_amd64.deb**查看本地安装包显示：**No packages found**| 要查看本地**xx.deb** 包的信息，应该使用**dpkg** 命令而不是 apt。正确的命令是：**dpkg -I qqmusic_1.1.3_amd64.deb** |
|2 |  **ping -c 5 www.xyl.cn** 显示：**Name or service not known**| **重启WSL2**，重新加载网络配置 |
|3|  安装包含 **nslookup** 的工具包后运行**nslookup www.baidu.com** 显示：**Command 'nslookup' not found**| **先更新软件包列表**再安装包含 nslookup 的工具包|